<html>
<head><title> "Simple Lightning effect" by NELSON CHU</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center">
<b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0242.PAS">Original</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0242.LIGHT1.ZIP">Attachment</a><b>]</b>

</p><!--StartFragment--><pre><code><font color="#008000"><i>{ [ Simple lightning effect ]
      By Nelson Chu, 1994

 This is the lightning effect used in my action puzzle game Mixed World.
 Feel free to change this program. If you have any improvement, please
 send me a copy too. Internet e-mail: eg_cshaa@stu.ust.hk

 Sorry that I just encode the .PAL file to be included here. I was too
 lazy to write a set-pal routine to set it on the fly.}

{$A+,R-,S-,N-,L-,O-,D-,X+,G+}
</i></font><font color="#FF0000"><b>uses </b></font>graphic<font color="#000080">, </font>crt<font color="#000080">;
</font><font color="#008000"><i>{Unit GRAPHIC to be found in GRAPHICS.SWG }
</i></font><font color="#FF0000"><b>var </b></font>pal <font color="#000080">: </font>paltype<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Lightning<font color="#000080">;  </font><font color="#008000"><i>{ a fractal effect }
</i></font><font color="#FF0000"><b>var </b></font>aa <font color="#000080">: </font>integer<font color="#000080">;
    </font>a<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>byte<font color="#000080">;

 </font><font color="#FF0000"><b>procedure </b></font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, </font>intensity<font color="#000080">, </font>dx <font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>part_int<font color="#000080">, </font>d <font color="#000080">: </font>byte<font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>add<font color="#000080">(</font>x<font color="#000080">:</font>word<font color="#000080">; </font>y<font color="#000080">, </font>int<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#FF0000"><b>begin if </b></font>screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">]&lt;</font>int <font color="#FF0000"><b>then </b></font>screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">]:=</font>int<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
  while </b></font><font color="#000080">(</font>intensity<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin

   </b></font>add<font color="#000080">( </font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);
   </font>add<font color="#000080">( </font>x<font color="#000080">,   </font>y<font color="#000080">, (</font>intensity<font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);
   </font>add<font color="#000080">( </font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">)*</font><font color="#800000">20</font><font color="#000080">+</font><font color="#800000">50</font><font color="#000080">);

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>y<font color="#000080">&gt;</font><font color="#800000">170</font><font color="#000080">)) </font><font color="#FF0000"><b>or
      </b></font><font color="#000080">((</font>random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&gt;</font><font color="#800000">5</font><font color="#000080">))</font><font color="#FF0000"><b>or
       </b></font><font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>intensity<font color="#000080">);

   </font>inc<font color="#000080">(</font>y<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{go next row every time}

   </i></font><font color="#FF0000"><b>if </b></font>dx<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font>dx<font color="#000080">)) </font><font color="#FF0000"><b>else </b></font>inc<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(-</font>dx<font color="#000080">));

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&lt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then begin </b></font>dec<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">); </font>dx<font color="#000080">:=-</font><font color="#800000">2</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>abs<font color="#000080">(</font>dx<font color="#000080">)&gt;</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then begin </b></font>inc<font color="#000080">(</font>x<font color="#000080">,</font>random<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">); </font>dx<font color="#000080">:=+</font><font color="#800000">2</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>y<font color="#000080">&gt;</font><font color="#800000">33</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>intensity<font color="#000080">&lt;</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{split}
   </i></font><font color="#FF0000"><b>begin
    </b></font>part_int<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat </b></font>d<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">); </font><font color="#FF0000"><b>until </b></font>d<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
    </font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">*</font>part_int<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font>y <font color="#FF0000"><b>div </b></font><font color="#800000">20</font><font color="#000080">, -</font>random<font color="#000080">(</font>d<font color="#000080">));
    </font>process<font color="#000080">( </font>x<font color="#000080">, </font>y<font color="#000080">, (</font>intensity<font color="#000080">*(</font><font color="#800000">10</font><font color="#000080">-</font>part_int<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">10 </font><font color="#000080">- </font>y <font color="#FF0000"><b>div </b></font><font color="#800000">20</font><font color="#000080">, </font>random<font color="#000080">(</font>d<font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>blacken<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
</font>aa<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);</font><font color="#008000"><i>{this is for delay}
</i></font><font color="#FF0000"><b>repeat

 repeat </b></font>delay<font color="#000080">(</font><font color="#800000">120</font><font color="#000080">); </font>dec<font color="#000080">(</font>aa<font color="#000080">); </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>aa<font color="#000080">&lt;=</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{do a variable delay}
 </i></font><font color="#FF0000"><b>repeat </b></font>aa<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">)-</font><font color="#800000">3</font><font color="#000080">; </font><font color="#FF0000"><b>until </b></font>abs<font color="#000080">(</font>aa<font color="#000080">)&gt;</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{get a good starting direction}

 </i></font>process<font color="#000080">( </font>random<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)+</font><font color="#800000">110</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>aa <font color="#000080">); </font><font color="#008000"><i>{get our discharge ready}

 </i></font>vsync<font color="#000080">;   </font>Setpal<font color="#000080">(</font>pal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
 </font>vsync<font color="#000080">;   </font>setcolor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">); </font><font color="#008000"><i>{sky suddenly brighten...}
 </i></font>vsync<font color="#000080">;   </font>setcolor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#008000"><i>{ repeat until keypressed;}
 </i></font>vsync<font color="#000080">;   </font>fadeout<font color="#000080">(</font>pal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

 </font>clearscreen<font color="#000080">(</font>screen<font color="#000080">);
</font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure message</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>write<font color="#000080">(
 </font><font color="#800000">'This is what you should do in order to enjoy this LIGHTNING demo :)'#13#13#10</font><font color="#000080">+
 </font><font color="#800000">' 1. If it''s now daytime or somebody is with you, wait until it is not.'#13#10</font><font color="#000080">+
 </font><font color="#800000">'    Press Ctrl-C to quit.'#13#10</font><font color="#000080">);
</font>write<font color="#000080">(
 </font><font color="#800000">' 2. Close all curtains/doors so that no light can enter your room.'#13#10</font><font color="#000080">+
 </font><font color="#800000">' 3. Sit back and press ENTER...'</font><font color="#000080">);

</font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>message2<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>write<font color="#000080">(</font><font color="#800000">'It should be with sounds too. But this is for SWAG... :P'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>randomize<font color="#000080">;
</font><font color="#FF0000"><b>message</b></font><font color="#000080">;
</font>setcrtmode<font color="#000080">(</font><font color="#800000">$13</font><font color="#000080">);
</font>loadpal<font color="#000080">(</font><font color="#800000">'light1.pal'</font><font color="#000080">, </font>pal<font color="#000080">, </font>true<font color="#000080">);
</font>lightning<font color="#000080">;
</font>setcrtmode<font color="#000080">(</font><font color="#800000">$3</font><font color="#000080">);
</font>message2<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

{------------------------- snip, snip ----------------------------}

ENCODED LIGHT1.PAL FILE REMOVED.  PLEASE <A HREF="0242.LIGHT1.ZIP">DOWNLOAD</A> EITHER THE 
ATTACHMENT OR THE COMPLETE ZIP FILE.
</i>
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to GRAPHICS SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0242.PAS">Original</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0242.LIGHT1.ZIP">Attachment</a><b>]</b>
</p></body>
</html>
