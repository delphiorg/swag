<html>
<head><title> "Change T.V. Colors" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center">
<b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0045.PAS">Original</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0045.COLOR.ZIP">Attachment</a><b>]</b>

</p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>Color<font color="#000080">;

</font><font color="#008000"><i>{$R color.res }

</i></font><font color="#FF0000"><b>uses
  </b></font>WinProcs<font color="#000080">,
  </font>WinTypes<font color="#000080">,
  </font>WObjects<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>White        <font color="#000080">= </font><font color="#800000">$00FFFFFF</font><font color="#000080">;
  </font>Black        <font color="#000080">= </font><font color="#800000">$00000000</font><font color="#000080">;
  </font>LightGray    <font color="#000080">= </font><font color="#800000">$00C0C0C0</font><font color="#000080">;
  </font>DarkGray     <font color="#000080">= </font><font color="#800000">$00808080</font><font color="#000080">;
  </font>Cyan         <font color="#000080">= </font><font color="#800000">$00FFFF00</font><font color="#000080">;
  </font>Magenta      <font color="#000080">= </font><font color="#800000">$00FF00FF</font><font color="#000080">;
  </font>Yellow       <font color="#000080">= </font><font color="#800000">$0000FFFF</font><font color="#000080">;
  </font>Red          <font color="#000080">= </font><font color="#800000">$000000FF</font><font color="#000080">;
  </font>Green        <font color="#000080">= </font><font color="#800000">$0000FF00</font><font color="#000080">;
  </font>Blue         <font color="#000080">= </font><font color="#800000">$00FF0000</font><font color="#000080">;
  </font>LightBlue    <font color="#000080">= </font><font color="#800000">$00800000</font><font color="#000080">;
  </font>LightCyan    <font color="#000080">= </font><font color="#800000">$00808000</font><font color="#000080">;
  </font>LightMagenta <font color="#000080">= </font><font color="#800000">$00800080</font><font color="#000080">;
  </font>Brown        <font color="#000080">= </font><font color="#800000">$00008080</font><font color="#000080">;
  </font>LightRed     <font color="#000080">= </font><font color="#800000">$00000080</font><font color="#000080">;
  </font>LightGreen   <font color="#000080">= </font><font color="#800000">$00008000</font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>id_Color <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PColorDialog <font color="#000080">= ^</font>TColorDialog<font color="#000080">;
  </font>TColorDialog <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TDialog<font color="#000080">)
    </font>ColorPtr <font color="#000080">: ^</font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>AColor <font color="#000080">: </font>longint<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetupWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CanClose <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>wmDrawItem<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">); </font><font color="#FF0000"><b>virtual </b></font>wm_First<font color="#000080">+</font>wm_DrawItem<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>wmMeasureItem<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">); </font><font color="#FF0000"><b>virtual </b></font>wm_First<font color="#000080">+</font>wm_MeasureItem<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TColorDialog<font color="#000080">.</font>Init<font color="#000080">(</font>AParent <font color="#000080">: </font>PWindowsObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>AColor <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>TDialog<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">,</font><font color="#800000">'ColorDlg'</font><font color="#000080">);
  </font>ColorPtr <font color="#000080">:= @</font>AColor<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Init }

</i></font><font color="#FF0000"><b>procedure </b></font>TColorDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>NColors <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
  </font>StdColors <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>NColors<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>longint <font color="#000080">=
   (</font>White<font color="#000080">, </font>Black<font color="#000080">, </font>LightGray<font color="#000080">, </font>DarkGray<font color="#000080">, </font>Cyan<font color="#000080">, </font>Magenta<font color="#000080">, </font>Yellow<font color="#000080">, </font>Red<font color="#000080">, </font>Green<font color="#000080">,
    </font>Blue<font color="#000080">, </font>LightBlue<font color="#000080">, </font>LightCyan<font color="#000080">, </font>LightMagenta<font color="#000080">, </font>Brown<font color="#000080">, </font>LightRed<font color="#000080">, </font>LightGreen<font color="#000080">);

  </font><font color="#FF0000"><b>procedure </b></font>SetupColors<font color="#000080">(</font>ID <font color="#000080">: </font>integer<font color="#000080">; </font>Color <font color="#000080">: </font>longint<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>i<font color="#000080">,</font>Sel <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Sel <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NColors <font color="#FF0000"><b>do begin
      </b></font>SendDlgItemMsg<font color="#000080">(</font>ID<font color="#000080">,</font>cb_AddString<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>StdColors<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>if </b></font>StdColors<font color="#000080">[</font>i<font color="#000080">] = </font>Color <font color="#FF0000"><b>then </b></font>Sel <font color="#000080">:= </font>pred<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Sel <font color="#000080">= -</font><font color="#800000">1 </font><font color="#FF0000"><b>then begin
      </b></font>SendDlgItemMsg<font color="#000080">(</font>ID<font color="#000080">,</font>cb_AddString<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Color<font color="#000080">);
      </font>Sel <font color="#000080">:= </font>NColors<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>SendDlgItemMsg<font color="#000080">(</font>ID<font color="#000080">,</font>cb_SetCurSel<font color="#000080">,</font>Sel<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetupColors }

</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ SetupWindow }
  </i></font>TDialog<font color="#000080">.</font>SetupWindow<font color="#000080">;
  </font>SetupColors<font color="#000080">(</font>id_Color<font color="#000080">,</font>ColorPtr<font color="#000080">^);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetupWindow }

</i></font><font color="#FF0000"><b>function </b></font>TColorDialog<font color="#000080">.</font>CanClose <font color="#000080">: </font>boolean<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>GetCol<font color="#000080">(</font>ID <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Color <font color="#000080">: </font>longint<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>Sel <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Sel <font color="#000080">:= </font>SendDlgItemMsg<font color="#000080">(</font>ID<font color="#000080">,</font>cb_GetCurSel<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Sel <font color="#000080">&gt; -</font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>SendDlgItemMsg<font color="#000080">(</font>ID<font color="#000080">,</font>cb_GetLBText<font color="#000080">,</font>Sel<font color="#000080">,</font>longint<font color="#000080">(@</font>Color<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetCol }

</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ CanClose }
  </i></font>GetCol<font color="#000080">(</font>id_Color<font color="#000080">,</font>ColorPtr<font color="#000080">^);
  </font>CanClose <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ CanClose }


</i></font><font color="#FF0000"><b>procedure </b></font>TColorDialog<font color="#000080">.</font>wmDrawItem<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Brush <font color="#000080">: </font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>PDrawItemStruct<font color="#000080">(</font>Msg<font color="#000080">.</font>lParam<font color="#000080">)^ </font><font color="#FF0000"><b>do begin
    if </b></font>CtlType <font color="#000080">= </font>odt_ComboBox <font color="#FF0000"><b>then begin
      if </b></font><font color="#000080">((</font>ItemAction <font color="#FF0000"><b>and </b></font>oda_DrawEntire<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or
         </b></font><font color="#000080">((</font>ItemAction <font color="#FF0000"><b>and </b></font>oda_Select<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>Brush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font>ItemData<font color="#000080">);
        </font>FillRect<font color="#000080">(</font>hDC<font color="#000080">,</font>rcItem<font color="#000080">,</font>Brush<font color="#000080">);
        </font>DeleteObject<font color="#000080">(</font>Brush<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ItemState <font color="#FF0000"><b>and </b></font>ods_Focus<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or
         </b></font><font color="#000080">((</font>ItemState <font color="#FF0000"><b>and </b></font>ods_Selected<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>InflateRect<font color="#000080">(</font>rcItem<font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">);
        </font>DrawFocusRect<font color="#000080">(</font>hDC<font color="#000080">,</font>rcItem<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ wmDrawItem }

</i></font><font color="#FF0000"><b>procedure </b></font>TColorDialog<font color="#000080">.</font>wmMeasureItem<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg <font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>PMeasureItemStruct<font color="#000080">(</font>Msg<font color="#000080">.</font>lParam<font color="#000080">)^.</font>ItemHeight <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ wmMeasureItem }

</i></font><font color="#FF0000"><b>const
  </b></font>cm_Color <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PColorWindow <font color="#000080">= ^</font>TColorWindow<font color="#000080">;
  </font>TColorWindow <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
    </font>Color <font color="#000080">: </font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Paint<font color="#000080">(</font>PaintDC<font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>PaintInfo<font color="#000080">: </font>TPaintStruct<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>CMColor<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
      </font><font color="#FF0000"><b>virtual </b></font>cm_First <font color="#000080">+ </font>cm_Color<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TColorWindow<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Color <font color="#000080">:= </font>White<font color="#000080">;
  </font>TWindow<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">'Color Combo Demo'</font><font color="#000080">);
  </font>Attr<font color="#000080">.</font>Menu <font color="#000080">:= </font>LoadMenu<font color="#000080">(</font>HInstance<font color="#000080">, </font><font color="#800000">'Menu'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Init }

</i></font><font color="#FF0000"><b>procedure </b></font>TColorWindow<font color="#000080">.</font>cmColor<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Application<font color="#000080">^.</font>ExecDialog<font color="#000080">(
       </font>New<font color="#000080">(</font>PColorDialog<font color="#000080">,</font>Init<font color="#000080">(@</font>Self<font color="#000080">,</font>Color<font color="#000080">))) = </font>id_Ok <font color="#FF0000"><b>then
    </b></font>InvalidateRect<font color="#000080">(</font>HWindow<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>true<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ cmColor }

</i></font><font color="#FF0000"><b>procedure </b></font>TColorWindow<font color="#000080">.</font>Paint<font color="#000080">(</font>PaintDC<font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>PaintInfo<font color="#000080">: </font>TPaintStruct<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Brush <font color="#000080">: </font>HBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Brush <font color="#000080">:= </font>CreateSolidBrush<font color="#000080">(</font>Color<font color="#000080">);
  </font>FillRect<font color="#000080">(</font>PaintDC<font color="#000080">,</font>PaintInfo<font color="#000080">.</font>rcPaint<font color="#000080">,</font>Brush<font color="#000080">);
  </font>DeleteObject<font color="#000080">(</font>Brush<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Paint }

</i></font><font color="#FF0000"><b>type
  </b></font>TColorApp <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TColorApp<font color="#000080">.</font>InitMainWindow<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PColorWindow<font color="#000080">,</font>Init<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ InitMainWindow }

</i></font><font color="#FF0000"><b>var
  </b></font>ColorApp<font color="#000080">: </font>TColorApp<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ColorApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'Menu'</font><font color="#000080">);
  </font>ColorApp<font color="#000080">.</font>Run<font color="#000080">;
  </font>ColorApp<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -------------------------  COLOR.RES ----------------------- }

ENCODED COLOR.RES FILE REMOVED.  PLEASE <A HREF="0045.COLOR.ZIP">DOWNLOAD</A> EITHER THE 
ATTACHMENT OR THE COMPLETE ZIP FILE.
</I>
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to OOP SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0045.PAS">Original</a><b>]</b>&nbsp;&nbsp;
<b>[</b><a href="0045.COLOR.ZIP">Attachment</a><b>]</b>
</p></body>
</html>
